<!DOCTYPE html>
<html lang="en">
<head>
<div th:replace="fragments/header :: meta" th:remove="tag"></div>
<div th:replace="fragments/header :: generalCss" th:remove="tag"></div>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
	rel="stylesheet" />
<div th:replace="fragments/header :: appCss" th:remove="tag"></div>

</head>
<body class="text-center">
	<!--  div th:replace="fragments/admin-fragments :: admin-nav" th:remove="tag"></div-->

	<h1 class="col-md-12" style="margin-bottom: 20px;">CDX Stridsjournal</h1>
		
	<div class="col-md-3 col-sm-4 col-8">
		<form class="text-left ">
			<div class="form-group">
						<label for="from">Få notifikasjoner for:</label> 
						<select class="form-control" id="audio-chooser">
							<option data-target="FELLES">Felles</option>
							<option data-target="SOC1">SOC 1</option>
							<option data-target="SOC2">SOC 2</option>
							<option data-target="SOC3">SOC 3</option>
							<option data-target="SOC4">SOC 4</option>
							<option data-target="SOC5">SOC 5</option>
							<option data-target="all">Alle</option>
						</select>
					</div>
				</form>
	</div>

	<div class="modal fade" id="newModal" tabindex="-1" role="dialog"
		aria-labelledby="add-tournament-modal-label" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">

					<h5 class="modal-title" id="exampleModalLabel">Ny Rapport</h5>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<form th:action="@{/message/send}" method="post" id="messageForm"
						class="text-left">
						
						<div class="form-group" style="display: none;">
							<div class="form-group">
								<label for="from">Fra</label> <select class="form-control"
									id="from">
									<option>TOC</option>
									<option>NOC</option>
									<option>EXCON</option>
									<option>RED CELL</option>
								</select>
							</div>
						</div>
						
						<div class="form-group">
							<div class="form-group">
								<label for="to">Til</label> <select class="form-control" id="to">
									<option>FELLES</option>
									<option>SOC1</option>
									<option>SOC2</option>
									<option>SOC3</option>
									<option>SOC4</option>
									<option>SOC5</option>
									<option>DropIn</option>
								</select>
							</div>
						</div>
						
						<div class="form-group">
							<label for="message">Hendelse</label>
							<textarea class="form-control" id="message" rows="5"></textarea>
						</div>
						
						<div class="form-check" style="display: none">
							<label class="form-check-label"> <input type="checkbox"
								class="form-check-input" id="requiresAction" /> Krever
								oppfølging
							</label>
						</div>
					</form>
					
					<div class="text-right">
						<button class="btn btn-primary" id="save">Lagre</button>
					</div>

				</div>
			</div>
		</div>
	</div>
	<div class="FAB" id="fab-add">
		<div class="FAB__action-button">
			<i class="action-button__icon material-icons">add</i>
			<p class="action-button__text--hide">Ny rapport</p>
		</div>
	</div>
	<div class="container-fluid">

		<div class="row">



			<div class="col-md-12">

				<ul class="nav nav-tabs">
					<li class="nav-item"><a data-target="felles" class="nav-link ">Felles</a></li>
					<li class="nav-item"><a data-target="soc1" class="nav-link">SOC1</a></li>
					<li class="nav-item"><a data-target="soc2" class="nav-link">SOC2</a></li>
					<li class="nav-item"><a data-target="soc3" class="nav-link">SOC3</a></li>
					<li class="nav-item"><a data-target="soc4" class="nav-link">SOC4</a></li>
					<li class="nav-item"><a data-target="soc5" class="nav-link">SOC5</a></li>
					<li class="nav-item"><a data-target="soc6" class="nav-link">DropIn</a></li>
					<li class="nav-item "><a data-target="all" class="nav-link active">Alle</a></li>
				</ul>
			
				<div class="messages">
					<div class="msg-container table-responsive text-left" id="all"
						>
						<table class="table" cellspacing="0" width="100%" id="msg-table">
							<thead>
								<tr class="felles">
									<th>DTG</th>
									<th>FRA</th>
									<th>TIL</th>
									<th>MELDING</th>
								</tr>
							</thead>
							<tbody id="message_table">
							</tbody>
						</table>
					</div>

				</div>	

			</div>

		</div>
	</div>
	<audio id="audio" src="/assets/mp3/notification.mp3"></audio>
	<div th:replace="fragments/javascript :: generalJs" th:remove="tag"></div>
	<!-- script src="/webjars/jquery/jquery.min.js"></script-->
	<script src="/webjars/sockjs-client/sockjs.min.js"></script>
    <script src="/webjars/stomp-websocket/stomp.min.js"></script>
	<script src="/assets/js/websocketclient.js"></script>
	<script>

		$(document).ready(function() {
			//alert(navigator.userAgent);

			CLIENT.ioController.initSaveButton();
			
			CLIENT.ioController.requestNotificationPermissions();
			
			CLIENT.webSocketController.connectAndSubscribe();
			
			//fetch all saved msg
			//subscribe
			getAllSavedMessages();
			
			//startFetchingMessages();
		})

	</script>
</body>
</html>
